#include"gl_weight.h"
/* original written by John Burkardt
M. M. Sussman
Converted to C code by Prince Chidyagwai
***************************************/

void gl_weight(int n,double a, double b, double* x, double* w)
{
    int i;
    if(n==1) {
	w[1] = 2.0;
	x[1] = 0.0;
    }
    else if(n==2) {
	w[1] = 1.0; 
	w[2] = w[1];

	x[1] = - 0.577350269189625764509148780502;
	x[2] =   0.577350269189625764509148780502;
    }
    else if(n == 3) {
	 w[1] =  5.0/9.0; 
	 w[2] =  8.0/9.0;
	 w[3] =  5.0/9.0;

	 x[1]= -0.774596669241483377035853079956;
	 x[2] = 0.000000000000000;
	 x[3] = 0.774596669241483377035853079956;
    }
    else if(n == 4) {
	 w[1] = 0.347854845137453857373063949222;
	 w[2] = 0.652145154862546142626936050778;
	 w[3] = 0.652145154862546142626936050778;
	 w[4] = 0.347854845137453857373063949222;

	 x[1] = -0.861136311594052575223946488893;
	 x[2] = -0.339981043584856264802665759103;
	 x[3] = 0.339981043584856264802665759103;
	 x[4] = 0.861136311594052575223946488893;
    }
    else if (n == 5) {
	 w[1] = 0.236926885056189087514264040720;
	 w[2] = 0.478628670499366468041291514836;
	 w[3] = 0.568888888888888888888888888889;
	 w[4] = 0.478628670499366468041291514836;
	 w[5] = 0.236926885056189087514264040720;

	 x[1] = -0.906179845938663992797626878299;
	 x[2] = - 0.538469310105683091036314420700;
	 x[3] = 0.0;
	 x[4] = 0.538469310105683091036314420700;
	 x[5] = 0.906179845938663992797626878299;
    }
    else if (n == 6) {
	w[1] = 0.171324492379170345040296142173;
	w[2] = 0.360761573048138607569833513838;
	w[3] = 0.467913934572691047389870343990;
	w[4] = 0.467913934572691047389870343990;
	w[5] = 0.360761573048138607569833513838;
	w[6] = 0.171324492379170345040296142173;

	x[1] = -0.932469514203152027812301554494;
	x[2] = -0.661209386466264513661399595020;
	x[3] = -0.238619186083196908630501721681;
	x[4] = 0.238619186083196908630501721681;
	x[5] = 0.661209386466264513661399595020;
	x[6] = 0.932469514203152027812301554494;
    }
    else if (n == 7) {	
	w[1] = 0.129484966168869693270611432679;
	w[2] = 0.279705391489276667901467771424;
	w[3] = 0.381830050505118944950369775489;
	w[4] = 0.417959183673469387755102040816;
	w[5] = 0.381830050505118944950369775489;
	w[6] = 0.279705391489276667901467771424;
	w[7] = 0.129484966168869693270611432679;

	x[1] = - 0.949107912342758524526189684048;
	x[2] = - 0.741531185599394439863864773281;
	x[3] = - 0.405845151377397166906606412077;
	x[4] =   0.0;
	x[5] =   0.405845151377397166906606412077;
	x[6] =   0.741531185599394439863864773281;
	x[7] =   0.949107912342758524526189684048;
    }
    else if(n ==12) {
	w[1] =  0.047175336386512;
	w[2] =  0.106939325995318;
	w[3] =  0.160078328543346;
	w[4] =  0.203167426723066;
	w[5] =  0.233492536538355;
	w[6] =  0.249147045813403;
	w[7] =  0.249147045813403;
	w[8] =  0.233492536538355;
	w[9] =  0.203167426723066;
	w[10] =  0.160078328543346;
	w[11]=  0.106939325995318;
	w[12]=  0.047175336386512;

	x[1] = -0.981560634246719;
	x[2] = -0.904117256370475;
	x[3] = -0.769902674194305;
	x[4] = -0.587317954286617;
	x[5] = -0.367831498998180;
	x[6] = -0.125233408511469;
	x[7] =  0.125233408511469;
	x[8] =  0.367831498998180;
	x[9] =  0.587317954286617;
	x[10] =  0.769902674194305;
	x[11]=  0.904117256370475;
	x[12]=  0.981560634246719;
    }
    else {
	printf("Warning:gl_weight %d not yet implemented \n",n);
    }

    //adjust the weights and coordinates for the interval [a,b]
    for(i=1;i< n+1;i++) 
    {
	    w[i] = w[i]*0.5;
	    x[i] = (0.5)*(a*(1-x[i]) + b*(1+x[i]));
    }
	
}

/*---------------------------------------------------------------
 * get_quadrature_segment: for dg part of code on (-1,1)
 * in:ng- number of quadrature points
 * out: xg and wg - quadrature points and weights
 * --------------------------------------------------------------*/

void get_quadrature_segment(int ng, double* xg, double* wg)
{
    if(ng==1) {
	xg[1] = 0.0;
	wg[1] = 2.0;
    }
    if(ng==2) {
	xg[1] = -0.577350269189;
	xg[2] =  0.577350269189;

	wg[1] = 1.0;
	wg[2] = 1.0;
    }
    if(ng ==3) {
	xg[1] = -0.774596669241;
	xg[2] =  0.0;
	xg[3] =  0.774596669241;

	wg[1] =  0.555555555555;
	wg[2] =  0.888888888888;
	wg[3] =  0.555555555555;
    }
}

